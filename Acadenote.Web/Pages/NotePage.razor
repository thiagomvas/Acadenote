@page "/note/{id}"
@using Acadenode.Core.Models
@using Acadenode.Core.Repositories
@inject INoteRepository _repo
@inject NavigationManager nav

@if (note == null)
{
    <PageTitle>Carregando...</PageTitle>
    <LoadingMessage />
}
else
{
    <PageTitle>@note.Title</PageTitle>
    <NoteView Note="note" />
}

@code {
    [Parameter]
    public string Id { get; set; }

    private Note? note;

    protected override async Task OnInitializedAsync()
    {
        note = await _repo.GetNoteByIdAsync(Id);
        if(note == null || note.Id == Note.NotFound.Id)
        {
            nav.NavigateTo("../404");
        }
    }
}